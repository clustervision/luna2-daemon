{% autoescape None %}

{% for ZONE in ZONES %}
zone "{{ ZONE }}" IN {
{%- if (not AUTHORITATIVE[ZONE]) and FORWARDERS[ZONE]|length > 0 %}
    type forward;
    forwarders {
  {%- for FORWARD in FORWARDERS[ZONE] %}
        {{ FORWARD }};
  {%- endfor %}
    };
    forward only;
{%- else %}
    type master;
    file "/var/named/{{ ZONE }}.luna.zone";
  {%- if DYNAMIC_UPDATES[ZONE] -%}
    {%- if OMAPIKEY or TSIGKEY %}
    update-policy {
      {%- if OMAPIKEY %}
        grant omapi_key zonesub A PTR TXT DHCID;
      {%- endif -%}
      {%- if TSIGKEY %}
        grant tsig_key zonesub A PTR TXT DHCID;
      {%- endif %}
    };
    {%- endif -%}
  {%- else %}
    allow-update { none; };
  {%- endif %}
    allow-transfer { none; };
{%- endif %}
};
{% endfor %}

{% endautoescape %}

